<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Quiz ‚Äî Anemia Ferropriva (Interativo)</title>
<style>
  :root{
    --bg:#0f1724; --card:#0b1220; --accent:#1f8feb; --muted:#94a3b8; --ok:#16a34a; --err:#ef4444;
    --glass: rgba(255,255,255,0.03);
  }
  body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; background:linear-gradient(180deg,#071020,#081426); color:#e6eef8; margin:0; padding:24px;}
  header{display:flex; gap:16px; align-items:center; margin-bottom:18px;}
  h1{font-size:20px; margin:0;}
  p.lead{margin:0; color:var(--muted); font-size:14px;}
  .container{display:grid; grid-template-columns: 1fr; gap:12px; max-width:980px; margin:0 auto;}
  .card{background:var(--card); border-radius:12px; padding:14px; box-shadow:0 6px 18px rgba(2,6,23,0.6); border:1px solid rgba(255,255,255,0.03);}
  .qhead{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:8px;}
  .qnum{font-weight:600; color:var(--accent);}
  .question{font-size:16px; margin-bottom:8px;}
  .options{display:flex; flex-direction:column; gap:8px;}
  label.option{background:var(--glass); padding:10px 12px; border-radius:8px; cursor:pointer; display:flex; align-items:center; gap:10px; border:1px solid transparent;}
  input[type="radio"]{accent-color:var(--accent); width:18px; height:18px;}
  label.option:hover{border-color:rgba(31,139,235,0.12);}
  .explain{margin-top:10px; padding:10px; border-radius:8px; background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); color:#cfe9ff; display:none; border-left:4px solid var(--accent);}
  .explain.ok{border-left-color:var(--ok);}
  .explain.err{border-left-color:var(--err);}
  .meta{font-size:13px; color:var(--muted); margin-top:6px;}
  footer{max-width:980px; margin:20px auto 60px; color:var(--muted); font-size:13px; text-align:center;}
  .controls{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:8px;}
  button{background:var(--accent); color:white; border:none; padding:8px 12px; border-radius:8px; cursor:pointer;}
  button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.06);}
  .scorecard{display:flex; gap:12px; align-items:center; flex-wrap:wrap;}
  .pill{background:rgba(255,255,255,0.04); padding:6px 10px; border-radius:999px; color:var(--muted); font-weight:600;}
  @media(min-width:900px){ .container{grid-template-columns: 1fr; } }
</style>
</head>
<body>
<header>
  <div>
    <h1>Quiz Interativo ‚Äî Anemia Ferropriva ü©∏</h1>
    <p class="lead">20+ quest√µes cobrindo metabolismo do ferro, diagn√≥stico, manifesta√ß√µes e tratamento ‚Äî explica√ß√µes aparecem ao escolher qualquer alternativa.</p>
  </div>
  <div style="margin-left:auto; text-align:right;">
    <div class="scorecard">
      <div class="pill" id="answeredCount">Respondidas: 0 / 22</div>
      <div class="pill" id="progressCorrect">Corretas: 0</div>
    </div>
  </div>
</header>

<main class="container" id="quiz"></main>

<footer class="card" style="max-width:980px; margin:18px auto;">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <div>
      <strong>Como usar</strong>
      <div class="meta">Escolha uma alternativa para ver a explica√ß√£o; voc√™ pode trocar a resposta a qualquer momento ‚Äî a explica√ß√£o atualizar√° automaticamente.</div>
    </div>
    <div style="display:flex; gap:8px;">
      <button id="showAll">Mostrar explica√ß√µes</button>
      <button class="ghost" id="reset">Reiniciar quiz</button>
    </div>
  </div>
</footer>

<script>
/* ========= Dados das quest√µes (baseado no PDF: Anemia Ferropriva) =========
   Cada item: {q, choices:[{text, correct:boolean, explain}], tags:[]}
   Explica√ß√µes curtas e objetivas (estudante 6¬∫ per√≠odo).
*/
const questions = [
  {
    q: "1) Qual √© a forma de ferro presente principalmente na hemoglobina e que corresponde a ~2/3 do ferro corporal?",
    choices: [
      {text:"Ferro heme (Fe2+) integrado √† hemoglobina", correct:true, explain:"Correto ‚Äî a maior parte do ferro funcional est√° na hemoglobina dentro dos eritr√≥citos."},
      {text:"Ferro ligado √† transferrina no plasma", correct:false, explain:"Errado ‚Äî ferro ligado √† transferrina √© a fra√ß√£o circulante, pequena comparada ao ferro na hemoglobina."},
      {text:"Ferro armazenado como hemossiderina", correct:false, explain:"Errado ‚Äî hemossiderina √© dep√≥sito, representa pequena fra√ß√£o dos estoques."},
      {text:"Ferro livre no citosol", correct:false, explain:"Errado ‚Äî ferro livre √© t√≥xico e n√£o existe em quantidades significativas no organismo."}
    ]
  },
  {
    q: "2) Qual prote√≠na s√©rica correlaciona-se com o estoque corporal total de ferro e √© medida para avaliar dep√≥sitos?",
    choices: [
      {text:"Ferritina", correct:true, explain:"Correto ‚Äî ferritina s√©rica se correlaciona com estoque de ferro e √© usada na avalia√ß√£o dos dep√≥sitos."},
      {text:"Transferrina", correct:false, explain:"Errado ‚Äî transferrina √© transportadora; sua concentra√ß√£o aumenta quando os estoques est√£o baixos, n√£o √© medida direta de dep√≥sito."},
      {text:"Hepcidina", correct:false, explain:"Errado ‚Äî hepcidina regula absor√ß√£o, mas n√£o √© usada rotineiramente como exame de estoque."},
      {text:"Hemossiderina", correct:false, explain:"Errado ‚Äî hemossiderina √© um dep√≥sito celular; n√£o √© uma medida s√©rica rotineira."}
    ]
  },
  {
    q: "3) Qual achado laboratorial √© considerado espec√≠fico (muito reduzido) para defici√™ncia de ferro?",
    choices:[
      {text:"Ferritina s√©rica muito baixa", correct:true, explain:"Correto ‚Äî ferritina muito baixa √© espec√≠fica para defici√™ncia de ferro."},
      {text:"Ferro s√©rico baixo", correct:false, explain:"Errado ‚Äî ferro s√©rico pode cair com inflama√ß√£o e varia com jejum/hor√°rio."},
      {text:"TIBC baixo", correct:false, explain:"Errado ‚Äî TIBC geralmente aumenta na defici√™ncia de ferro."},
      {text:"Satura√ß√£o de transferrina elevada", correct:false, explain:"Errado ‚Äî na defici√™ncia a satura√ß√£o costuma estar reduzida."}
    ]
  },
  {
    q: "4) A hip√≥tese: qual √© o padr√£o-ouro descrito no PDF para demonstrar dep√≥sito de ferro na medula?",
    choices:[
      {text:"Colora√ß√£o de Perls (azul de Pr√∫ssia) da medula", correct:true, explain:"Correto ‚Äî a colora√ß√£o de Perls para ferro na medula √© referida como padr√£o-ouro para estoques."},
      {text:"Dosagem de ferro s√©rico", correct:false, explain:"Errado ‚Äî ferro s√©rico n√£o reflete diretamente os dep√≥sitos."},
      {text:"Radiografia √≥ssea", correct:false, explain:"Errado ‚Äî n√£o avalia dep√≥sitos de ferro."},
      {text:"Hemograma completo", correct:false, explain:"Errado ‚Äî hemograma n√£o mostra diretamente dep√≥sitos de ferro."}
    ]
  },
  {
    q: "5) Sobre absor√ß√£o intestinal do ferro: qual forma do ferro alimentar √© melhor absorvida?",
    choices:[
      {text:"Ferro heme (de origem animal, Fe2+)", correct:true, explain:"Correto ‚Äî ferro heme (Fe2+) √© melhor absorvido; forma heme de origem animal tem maior biodisponibilidade."},
      {text:"Ferro n√£o-heme (Fe3+) vegetal", correct:false, explain:"Errado ‚Äî ferro n√£o-heme √© menos absorvido e mais influenciado por inibidores/promotores da dieta."},
      {text:"Ferro ligado √† ferritina diet√©tica", correct:false, explain:"Errado ‚Äî ferritina diet√©tica n√£o √© a principal via de absor√ß√£o; o ferro heme domina absor√ß√£o eficiente."},
      {text:"Ferro livre na forma i√¥nica (Fe0)", correct:false, explain:"Errado ‚Äî Fe0 n√£o √© forma fisiol√≥gica/diet√°ria relevante."}
    ]
  },
  {
    q: "6) Qual pept√≠deo hep√°tico regula a absor√ß√£o intestinal do ferro?",
    choices:[
      {text:"Hepcidina", correct:true, explain:"Correto ‚Äî hepcidina, produzida pelo f√≠gado, regula a taxa de absor√ß√£o do ferro."},
      {text:"Eritropoietina", correct:false, explain:"Errado ‚Äî eritropoietina estimula eritropoese; n√£o regula diretamente a absor√ß√£o intestinal."},
      {text:"Transferrina", correct:false, explain:"Errado ‚Äî transferrina √© transportadora, n√£o reguladora da absor√ß√£o."},
      {text:"Ferritina", correct:false, explain:"Errado ‚Äî ferritina armazena ferro, n√£o regula absor√ß√£o."}
    ]
  },
  {
    q: "7) Na defici√™ncia de ferro, como costuma se comportar a transferrina e o TIBC?",
    choices:[
      {text:"Transferrina aumenta e TIBC aumenta", correct:true, explain:"Correto ‚Äî produ√ß√£o de transferrina aumenta quando estoques baixos; TIBC (medida indireta) tamb√©m se eleva."},
      {text:"Transferrina diminui e TIBC diminui", correct:false, explain:"Errado ‚Äî isso ocorre em inflama√ß√£o, n√£o em defici√™ncia pura de ferro."},
      {text:"Transferrina aumenta e TIBC diminui", correct:false, explain:"Errado ‚Äî ambos tendem a aumentar juntos na defici√™ncia de ferro."},
      {text:"Sem altera√ß√£o na transferrina; TIBC aumenta", correct:false, explain:"Errado ‚Äî transferrina geralmente aumenta com a TIBC."}
    ]
  },
  {
    q: "8) O √≠ndice de satura√ß√£o da transferrina (IST) √© calculado basicamente por qual raz√£o?",
    choices:[
      {text:"Ferro s√©rico / TIBC (ou transferrina) √ó constante", correct:true, explain:"Correto ‚Äî IST = (ferro s√©rico / TIBC) ou raz√£o similar; valores t√≠picos ~20‚Äì45%."},
      {text:"Ferritina / ferro s√©rico", correct:false, explain:"Errado ‚Äî essa n√£o √© a f√≥rmula do IST."},
      {text:"Transferrina / ferritina", correct:false, explain:"Errado ‚Äî tamb√©m incorreto."},
      {text:"TIBC / ferro s√©rico", correct:false, explain:"Errado ‚Äî √© o inverso da raz√£o usada no IST."}
    ]
  },
  {
    q: "9) Qual percentual aproximado do ferro diet√©tico √© absorvido normalmente?",
    choices:[
      {text:"Cerca de 10%", correct:true, explain:"Correto ‚Äî aproximadamente 10% do ferro na dieta √© absorvido em condi√ß√µes normais."},
      {text:"Cerca de 50%", correct:false, explain:"Errado ‚Äî 50% √© muito alto para absor√ß√£o diet√©tica normal."},
      {text:"Quase 0%", correct:false, explain:"Errado ‚Äî n√£o √© zero; h√° absor√ß√£o regulada."},
      {text:"100%", correct:false, explain:"Errado ‚Äî absor√ß√£o total n√£o ocorre; √© muito menor."}
    ]
  },
  {
    q: "10) Qual √© a perda m√©dia di√°ria de ferro pelo organismo em adultos (vias n√£o-menstruais)?",
    choices:[
      {text:"~1 mg/dia por descama√ß√£o e secre√ß√µes", correct:true, explain:"Correto ‚Äî n√£o h√° excre√ß√£o fisiol√≥gica eficiente; perdas di√°rias ~1 mg por descama√ß√£o celular e outras vias."},
      {text:"~10 mg/dia por urina", correct:false, explain:"Errado ‚Äî perdas urin√°rias n√£o chegam a isso em valores normais."},
      {text:"~50 mg/dia por suor", correct:false, explain:"Errado ‚Äî suor n√£o causa perda t√£o alta de ferro."},
      {text:"Nenhuma perda di√°ria", correct:false, explain:"Errado ‚Äî h√° perdas di√°rias pequenas, ~1 mg."}
    ]
  },
  {
    q: "11) Em mulheres em idade reprodutiva, a menstrua√ß√£o normal leva a perda aproximada de quanto ferro por m√™s?",
    choices:[
      {text:"15‚Äì30 mg de ferro por m√™s", correct:true, explain:"Correto ‚Äî menstrua√ß√£o de 30‚Äì60 mL de sangue/m√™s corresponde a ~15‚Äì30 mg de ferro."},
      {text:"1‚Äì2 mg por m√™s", correct:false, explain:"Errado ‚Äî valor muito baixo; menstrua√ß√£o causa perda significativamente maior."},
      {text:"100‚Äì150 mg por m√™s", correct:false, explain:"Errado ‚Äî valor muito alto para perda menstrual normal."},
      {text:"N√£o h√° perda de ferro com menstrua√ß√£o", correct:false, explain:"Errado ‚Äî h√° perda significativa de ferro com menstrua√ß√£o."}
    ]
  },
  {
    q: "12) Quais s√£o manifesta√ß√µes cl√≠nicas cl√°ssicas de anemia ferropriva?",
    choices:[
      {text:"Palidez, fadiga, intoler√¢ncia ao exerc√≠cio e pica (por exemplo, ingest√£o de gelo)", correct:true, explain:"Correto ‚Äî essas s√£o manifesta√ß√µes t√≠picas descritas no PDF."},
      {text:"Icter√≠cia franca e dor lombar", correct:false, explain:"Errado ‚Äî icter√≠cia e dor lombar n√£o s√£o sinais cl√°ssicos de defici√™ncia de ferro."},
      {text:"Hiperpigmenta√ß√£o cut√¢nea e hipertens√£o", correct:false, explain:"Errado ‚Äî n√£o caracter√≠stico da anemia ferropriva."},
      {text:"Excesso de peso e edema perif√©rico", correct:false, explain:"Errado ‚Äî n√£o s√£o manifesta√ß√µes t√≠picas de defici√™ncia de ferro."}
    ]
  },
  {
    q: "13) Qual sinal ungueal √© associado √† defici√™ncia de ferro?",
    choices:[
      {text:"Coilon√≠quia (unhas em forma de colher)", correct:true, explain:"Correto ‚Äî coilon√≠quia √© t√≠pica da defici√™ncia de ferro."},
      {text:"Onic√≥lise por trauma", correct:false, explain:"Errado ‚Äî onic√≥lise traum√°tica n√£o √© sinal espec√≠fico de defici√™ncia de ferro."},
      {text:"Hiperqueratose subungueal", correct:false, explain:"Errado ‚Äî n√£o √© o achado cl√°ssico citado."},
      {text:"Melanoniquia", correct:false, explain:"Errado ‚Äî pigmenta√ß√£o ungueal n√£o √© t√≠pica de anemia ferropriva."}
    ]
  },
  {
    q: "14) A s√≠ndrome de Plummer-Vinson est√° associada √† defici√™ncia de ferro e pode apresentar qual sinal?",
    choices:[
      {text:"Disfagia por membranas esof√°gicas", correct:true, explain:"Correto ‚Äî Plummer-Vinson pode causar disfagia por membranas/esofagite e atrofia das papilas linguais."},
      {text:"Hepatoesplenomegalia maci√ßa", correct:false, explain:"Errado ‚Äî n√£o √© caracter√≠stica da Plummer-Vinson."},
      {text:"Fotofobia intensa", correct:false, explain:"Errado ‚Äî n√£o relacionado."},
      {text:"Ascite", correct:false, explain:"Errado ‚Äî n√£o √© t√≠pico nessa s√≠ndrome."}
    ]
  },
  {
    q: "15) Em rela√ß√£o ao tratamento oral da defici√™ncia de ferro, qual √© a dose ideal di√°ria de ferro elementar para adultos, segundo o PDF?",
    choices:[
      {text:"180‚Äì200 mg de ferro elementar por dia (dividido em 3‚Äì4 tomadas)", correct:true, explain:"Correto ‚Äî o PDF recomenda 180‚Äì200 mg de ferro elementar/dia para adultos, em doses divididas."},
      {text:"10 mg de ferro elementar ao dia", correct:false, explain:"Errado ‚Äî muito abaixo da dose terap√™utica recomendada."},
      {text:"1 g por dia de ferro elementar", correct:false, explain:"Errado ‚Äî dose excessiva e t√≥xica."},
      {text:"50 mg por semana", correct:false, explain:"Errado ‚Äî frequ√™ncia/dose inadequadas para tratamento agudo."}
    ]
  },
  {
    q: "16) Qual √© o sinal laboratorial mais precoce de resposta √† reposi√ß√£o de ferro?",
    choices:[
      {text:"Aumento da contagem de reticul√≥citos (pico entre 5‚Äì10 dias)", correct:true, explain:"Correto ‚Äî aumento dos reticul√≥citos √© o primeiro sinal de resposta, pico entre 5¬∫ e 10¬∫ dia."},
      {text:"Queda imediata da ferritina em 24h", correct:false, explain:"Errado ‚Äî ferritina n√£o cai assim; ela varia com tempo e inflama√ß√£o."},
      {text:"Aumento s√∫bito da Hb em 24h", correct:false, explain:"Errado ‚Äî Hb demora mais tempo; aumento m√©dio ~1 g/dL/semana."},
      {text:"Normaliza√ß√£o imediata do TIBC", correct:false, explain:"Errado ‚Äî altera√ß√µes no TIBC ocorrem mais lentamente."}
    ]
  },
  {
    q: "17) Aumento m√©dio esperado da hemoglobina ap√≥s in√≠cio da reposi√ß√£o de ferro por semana:",
    choices:[
      {text:"~1 g/dL por semana", correct:true, explain:"Correto ‚Äî aumento m√©dio de ‚âà1 g/dL de Hb por semana √© descrito no PDF."},
      {text:"~5 g/dL por semana", correct:false, explain:"Errado ‚Äî aumento t√£o r√°pido n√£o √© realista nem seguro."},
      {text:"Sem altera√ß√£o por v√°rias semanas", correct:false, explain:"Errado ‚Äî normalmente j√° h√° resposta na contagem de reticul√≥citos e progress√£o da Hb."},
      {text:"Queda da Hb inicialmente", correct:false, explain:"Errado ‚Äî a tend√™ncia √© de aumento, n√£o de queda, ap√≥s reposi√ß√£o adequada."}
    ]
  },
  {
    q: "18) Quais situa√ß√µes indicam considerar reposi√ß√£o parenteral de ferro?",
    choices:[
      {text:"Quando via oral √© ineficaz, intoler√°vel ou h√° necessidade de reposi√ß√£o r√°pida", correct:true, explain:"Correto ‚Äî indica√ß√µes incluem intoler√¢ncia a VO, m√° absor√ß√£o, ou necessidade cl√≠nica de reposi√ß√£o mais r√°pida/eficaz."},
      {text:"Sempre na anemia leve sem investiga√ß√£o", correct:false, explain:"Errado ‚Äî tratamento oral √© prefer√≠vel inicialmente em casos sem contra-indica√ß√£o."},
      {text:"Somente quando ferritina >1000 ng/mL", correct:false, explain:"Errado ‚Äî ferritina t√£o alta exclui defici√™ncia; n√£o √© indica√ß√£o de parenteral."},
      {text:"Em aus√™ncia absoluta de sintomas", correct:false, explain:"Errado ‚Äî aus√™ncia de sintomas n√£o √© por si indica√ß√£o para via parenteral."}
    ]
  },
  {
    q: "19) Quais efeitos adversos s√£o comuns com suplementos orais de ferro?",
    choices:[
      {text:"Altera√ß√£o da cor das fezes, n√°useas, dor epig√°strica, constipa√ß√£o/diarreia", correct:true, explain:"Correto ‚Äî esses efeitos gastrointestinais e altera√ß√£o da cor das fezes s√£o t√≠picos."},
      {text:"Sede excessiva e perda de audi√ß√£o", correct:false, explain:"Errado ‚Äî n√£o s√£o efeitos t√≠picos da suplementa√ß√£o oral de ferro."},
      {text:"Cicatriza√ß√£o acelerada de feridas", correct:false, explain:"Errado ‚Äî n√£o √© descrito como efeito adverso comum."},
      {text:"Hipotireoidismo", correct:false, explain:"Errado ‚Äî suplementa√ß√£o de ferro n√£o causa hipotireoidismo diretamente."}
    ]
  },
  {
    q: "20) Hemossiderina corresponde a:",
    choices:[
      {text:"Agregado de ferro/derivados dentro de macr√≥fagos (dep√≥sito)", correct:true, explain:"Correto ‚Äî hemossiderina √© dep√≥sito de ferro em macr√≥fagos (medula, f√≠gado, ba√ßo) e representa pequena fra√ß√£o dos estoques."},
      {text:"Forma de ferro circulante ligada √† transferrina", correct:false, explain:"Errado ‚Äî isso descreve ferro ligado √† transferrina, n√£o hemossiderina."},
      {text:"Prote√≠na que transporta duas mol√©culas de ferro", correct:false, explain:"Errado ‚Äî isso descreve transferrina."},
      {text:"Um horm√¥nio que regula absor√ß√£o de ferro", correct:false, explain:"Errado ‚Äî isso descreve hepcidina, n√£o hemossiderina."}
    ]
  },
  {
    q: "21) Em presen√ßa de infec√ß√£o aguda, como comporta-se a ferritina s√©rica?",
    choices:[
      {text:"Pode elevar-se (√© prote√≠na de fase aguda), mascarando defici√™ncia", correct:true, explain:"Correto ‚Äî ferritina √© prote√≠na de fase aguda; n√≠veis normais/elevados n√£o excluem defici√™ncia em inflama√ß√£o."},
      {text:"Sempre diminui rapidamente", correct:false, explain:"Errado ‚Äî tende a aumentar na inflama√ß√£o, n√£o diminuir."},
      {text:"Permanece inalterada e sempre reflete estoques", correct:false, explain:"Errado ‚Äî inflama√ß√£o altera ferritina s√©rica."},
      {text:"√â substitu√≠da pelo TIBC como marcador", correct:false, explain:"Errado ‚Äî TIBC √© outro par√¢metro; ferritina continua sendo avaliada, mas com cautela em inflama√ß√£o."}
    ]
  },
  {
    q: "22) Quais mecanismos contribuem para a defici√™ncia de ferro (etiologia multifatorial)?",
    choices:[
      {text:"Baixa ingest√£o, m√° absor√ß√£o, perdas cr√¥nicas (sangramento), aumento de demanda (gesta√ß√£o)", correct:true, explain:"Correto ‚Äî defici√™ncia de ferro √© multifatorial: ingesta insuficiente, perdas e demanda aumentada."},
      {text:"Excesso de ingest√£o de vitamina C", correct:false, explain:"Errado ‚Äî vitamina C na verdade aumenta absor√ß√£o de ferro."},
      {text:"Exclusivamente gen√©tica sem rela√ß√£o com dieta", correct:false, explain:"Errado ‚Äî embora existam causas gen√©ticas para doen√ßas do ferro, a defici√™ncia √© geralmente por desequil√≠brio dieta/absor√ß√£o/perdas."},
      {text:"Somente por consumo excessivo de ferro", correct:false, explain:"Errado ‚Äî consumo excessivo causaria sobrecarga, n√£o defici√™ncia."}
    ]
  }
];

/* ===== utilities ===== */
function shuffle(array){
  for(let i = array.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
  return array;
}

/* ===== render quiz ===== */
const quizEl = document.getElementById('quiz');
let state = { answered:0, correct:0 };
function render(){
  quizEl.innerHTML = '';
  questions.forEach((item, idx) => {
    // clone choices and shuffle to vary order
    const choices = shuffle(item.choices.map((c,i)=>({...c, id: `q${idx}_c${i}`})));
    const wrap = document.createElement('section');
    wrap.className = 'card';
    wrap.dataset.qindex = idx;
    wrap.innerHTML = `
      <div class="qhead">
        <div class="qnum">Quest√£o ${idx+1}</div>
        <div class="meta">${item.tags ? item.tags.join(',') : ''}</div>
      </div>
      <div class="question">${item.q}</div>
      <div class="options" id="opts-${idx}"></div>
      <div class="explain" id="exp-${idx}" role="status" aria-live="polite"></div>
    `;
    const optsEl = wrap.querySelector(`#opts-${idx}`);
    choices.forEach((c, i)=>{
      const lab = document.createElement('label');
      lab.className = 'option';
      lab.innerHTML = `<input type="radio" name="q${idx}" data-correct="${c.correct}" data-explain="${escapeHtml(c.explain)}"> <div>${c.text}</div>`;
      optsEl.appendChild(lab);
      // add listener
      lab.querySelector('input').addEventListener('change', (e)=>{
        handleAnswer(idx, e.target);
      });
    });
    quizEl.appendChild(wrap);
  });
  updateStatus();
}

/* escape for data attribute */
function escapeHtml(s){
  return s.replace(/"/g,'&quot;').replace(/'/g,"&#39;");
}

/* handle selection */
function handleAnswer(qIndex, inputEl){
  const expEl = document.getElementById(`exp-${qIndex}`);
  const correct = (inputEl.dataset.correct === 'true');
  const explain = inputEl.dataset.explain || '';
  expEl.style.display = 'block';
  expEl.innerHTML = (correct ? '‚úÖ <strong>Correto.</strong> ' : '‚ùå <strong>Incorreto.</strong> ') + htmlUnescape(explain);
  expEl.classList.toggle('ok', correct);
  expEl.classList.toggle('err', !correct);
  // update progress: we count a question as 'answered' if any radio in that group checked
  updateProgress();
}

/* unescape HTML entities */
function htmlUnescape(s){
  return s.replace(/&quot;/g,'"').replace(/&#39;/g,"'");
}

/* update answered/correct counts */
function updateProgress(){
  let answered = 0, correct = 0;
  questions.forEach((_, idx)=>{
    const radios = document.getElementsByName(`q${idx}`);
    let any=false, corr=false;
    for(const r of radios){
      if(r.checked){ any=true; if(r.dataset.correct==='true') corr=true; break;}
    }
    if(any) answered++;
    if(corr) correct++;
  });
  state.answered = answered; state.correct = correct;
  updateStatus();
}

/* update UI status */
function updateStatus(){
  document.getElementById('answeredCount').textContent = `Respondidas: ${state.answered} / ${questions.length}`;
  document.getElementById('progressCorrect').textContent = `Corretas: ${state.correct}`;
}

/* show all explanations (reveal based on current selection) */
document.getElementById('showAll').addEventListener('click', ()=>{
  questions.forEach((_, idx)=>{
    const radios = document.getElementsByName(`q${idx}`);
    const expEl = document.getElementById(`exp-${idx}`);
    let any=false;
    for(const r of radios){
      if(r.checked){ any=true; const correct = r.dataset.correct==='true'; expEl.style.display='block'; expEl.innerHTML = (correct ? '‚úÖ <strong>Correto.</strong> ' : '‚ùå <strong>Incorreto.</strong> ') + htmlUnescape(r.dataset.explain); expEl.classList.toggle('ok', correct); expEl.classList.toggle('err', !correct); break;}
    }
    if(!any){
      expEl.style.display='block';
      expEl.innerHTML = `<em class="meta">Nenhuma alternativa selecionada ‚Äî escolha uma para ver a explica√ß√£o.</em>`;
      expEl.classList.remove('ok','err');
    }
  });
  updateProgress();
});

/* reset */
document.getElementById('reset').addEventListener('click', ()=>{
  // clear radios and hides explanations
  questions.forEach((_, idx)=>{
    const radios = document.getElementsByName(`q${idx}`);
    for(const r of radios) r.checked = false;
    const expEl = document.getElementById(`exp-${idx}`);
    expEl.style.display = 'none';
    expEl.innerHTML = '';
    expEl.classList.remove('ok','err');
  });
  state.answered = 0; state.correct = 0;
  updateStatus();
});

/* initialize */
render();

/* Accessibility: allow changing answer at any time (radios already allow this).
   Also, ensure explanation updates on change (handled).
*/
</script>
</body>
</html>
